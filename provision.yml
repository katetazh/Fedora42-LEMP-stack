--- 

  - name: Setting Up fedora42 
    become: true 
    hosts: lemp 


    pre_tasks: 

    - name: Update DNF package cache
      dnf:
        update_cache: true
      register: cache_update
      retries: 3
      delay: 5
      until: cache_update is success


    - name: Upgrade all packages to the latest version
      dnf:
        name: '*'
        state: latest
        update_cache: false
      register: package_upgrade
      retries: 3
      delay: 5
      until: package_upgrade is success


    - name: Clean up unused packages and cache
      dnf:
        autoremove: true
      when: package_upgrade.changed


    roles: 
      - common
      - mariadb
      - nginx
      - php
      - wordpress
      - dnsmasq
      - security






